
<div class="container">
    <div class="row">
        <div class="col">
            <h1>Card Index</h1>
        </div>
        <div class="col-md-auto">
            <p>
                <a asp-action="Create" class="btn btn-primary">Create New Card</a>
            </p>
        </div>
        <div class="col col-lg-2">
            <p>
                <a asp-action="GetCard" class="btn btn-warning">Start Playing</a>
            </p>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col">
            <h6>Currently Displaying 100 out of @ViewBag.TotalCards</h6>
        </div>
        <div class="col-md-auto">
            <p>
                <a asp-action="ViewAllCards" class="btn btn-primary">View All @ViewBag.TotalCards</a>
            </p>
        </div>
        <div class="col col-lg-2">
            <p>
                <a asp-action="GetCard" class="btn btn-warning">Start Playing</a>
            </p>
        </div>
    </div>
</div>
<div class="control-section">
    <ejs-grid id="Grid" dataSource="ViewBag.datasource" toolbarClick="toolbarClick" allowPaging="true" allowExcelExport="true" toolbar="@(new List<string>() {"Search", "Add", "Edit", "Delete", "Cancel", "Update","PdfExport","ExcelExport"})" allowSorting="true">
        <e-grid-editSettings allowAdding="true" allowDeleting="true" allowEditing="true" mode="Dialog" template='#dialogtemplate'></e-grid-editSettings>
        <e-grid-pagesettings pageCount="5"></e-grid-pagesettings>
        <e-grid-columns>
            <e-grid-column field="Question" headerText="Question" width="120"></e-grid-column>
            <e-grid-column field="Answer" headerText="Answer" width="150"></e-grid-column>
            <e-grid-column field="Type" headerText="Type" width="70"></e-grid-column>
        </e-grid-columns>
    </ejs-grid>
</div>
<script id='dialogtemplate' type="text/x-template">
    <div id="dialogTemp"></div>
</script>
<script>
    function toolbarClick(args) {
        var gridObj = document.getElementById("Grid").ej2_instances[0];
        if (args.item.id === 'Grid_pdfexport') {
            gridObj.pdfExport();
        }
        if (args.item.id === 'Grid_excelexport') {
            gridObj.excelExport();
        }
    }
</script>
<script>
    function actionComplete(args) {
        if (args.requestType === 'beginEdit') {
            var ajax = new ej.base.Ajax({
                url: "/Grid/EditPartial", //render the partial view
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({ value: args.rowData })
            });
            ajax.send().then(function (data) {
                appendElement(data, args.form); //Render the edit form with selected record
                args.form.elements.namedItem('CustomerID').focus();
            }).catch(function (xhr) {
                console.log(xhr);
            });
        }

        if (args.requestType === 'add') {
            var ajax = new ej.base.Ajax({
                url: "/Grid/AddPartial", //render the partial view
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({ value: args.rowData })
            });
            ajax.send().then(function (data) {
                appendElement(data, args.form); //Render the edit form with selected record
                args.form.elements.namedItem('OrderID').focus();
            }).catch(function (xhr) {
                console.log(xhr);
            });
        }
    }

    function appendElement(elementString, form) {
        form.querySelector("#dialogTemp").innerHTML = elementString;
        var script = document.createElement('script');
        script.type = "text/javascript";
        var serverScript = form.querySelector("#dialogTemp").querySelector('script');
        script.textContent = serverScript.innerHTML;
        document.head.appendChild(script);
        serverScript.remove();
    }
</script>
<link rel="stylesheet" href="~/css/material.css" />
<script src="~/js/ej2.js"></script>
